
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Working with Time Series &#8212; Data Mining</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '03.11-Working-with-Time-Series';</script>
    <link rel="icon" href="_static/fum-logo.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="High-Performance Pandas: eval and query" href="03.12-Performance-Eval-and-Query.html" />
    <link rel="prev" title="Vectorized String Operations" href="03.10-Working-With-Strings.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/fum-cs-logo.png" class="logo__image only-light" alt="Data Mining - Home"/>
    <script>document.write(`<img src="_static/fum-cs-logo.png" class="logo__image only-dark" alt="Data Mining - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to Data Mining Course
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to NumPy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="02.00-Introduction-to-NumPy.html">Introduction to NumPy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="02.01-Understanding-Data-Types.html">Understanding Data Types in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="02.02-The-Basics-Of-NumPy-Arrays.html">The Basics of NumPy Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="02.03-Computation-on-arrays-ufuncs.html">Computation on NumPy Arrays: Universal Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="02.04-Computation-on-arrays-aggregates.html">Aggregations: min, max, and Everything in Between</a></li>
<li class="toctree-l2"><a class="reference internal" href="02.05-Computation-on-arrays-broadcasting.html">Computation on Arrays: Broadcasting</a></li>
<li class="toctree-l2"><a class="reference internal" href="02.06-Boolean-Arrays-and-Masks.html">Comparisons, Masks, and Boolean Logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="02.07-Fancy-Indexing.html">Fancy Indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="02.08-Sorting.html">Sorting Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="02.09-Structured-Data-NumPy.html">Structured Data: NumPy’s Structured Arrays</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Manipulation with Pandas</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="03.00-Introduction-to-Pandas.html">Data Manipulation with Pandas</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="03.01-Introducing-Pandas-Objects.html">Introducing Pandas Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="03.02-Data-Indexing-and-Selection.html">Data Indexing and Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="03.03-Operations-in-Pandas.html">Operating on Data in Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="03.04-Missing-Values.html">Handling Missing Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="03.05-Hierarchical-Indexing.html">Hierarchical Indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="03.06-Concat-And-Append.html">Combining Datasets: concat and append</a></li>
<li class="toctree-l2"><a class="reference internal" href="03.07-Merge-and-Join.html">Combining Datasets: merge and join</a></li>
<li class="toctree-l2"><a class="reference internal" href="03.08-Aggregation-and-Grouping.html">Aggregation and Grouping</a></li>
<li class="toctree-l2"><a class="reference internal" href="03.09-Pivot-Tables.html">Pivot Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="03.10-Working-With-Strings.html">Vectorized String Operations</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Working with Time Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="03.12-Performance-Eval-and-Query.html">High-Performance Pandas: eval and query</a></li>
<li class="toctree-l2"><a class="reference internal" href="03.13-Further-Resources.html">Further Resources</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Visualization with Matplotlib</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="04.00-Introduction-To-Matplotlib.html">Visualization with Matplotlib</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="04.01-Simple-Line-Plots.html">Simple Line Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="04.02-Simple-Scatter-Plots.html">Simple Scatter Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="04.03-Errorbars.html">Visualizing Uncertainties</a></li>
<li class="toctree-l2"><a class="reference internal" href="04.04-Density-and-Contour-Plots.html">Density and Contour Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="04.05-Histograms-and-Binnings.html">Histograms, Binnings, and Density</a></li>
<li class="toctree-l2"><a class="reference internal" href="04.06-Customizing-Legends.html">Customizing Plot Legends</a></li>
<li class="toctree-l2"><a class="reference internal" href="04.07-Customizing-Colorbars.html">Customizing Colorbars</a></li>
<li class="toctree-l2"><a class="reference internal" href="04.08-Multiple-Subplots.html">Multiple Subplots</a></li>
<li class="toctree-l2"><a class="reference internal" href="04.09-Text-and-Annotation.html">Text and Annotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="04.10-Customizing-Ticks.html">Customizing Ticks</a></li>
<li class="toctree-l2"><a class="reference internal" href="04.11-Settings-and-Stylesheets.html">Customizing Matplotlib: Configurations and Stylesheets</a></li>
<li class="toctree-l2"><a class="reference internal" href="04.12-Three-Dimensional-Plotting.html">Three-Dimensional Plotting in Matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="04.14-Visualization-With-Seaborn.html">Visualization with Seaborn</a></li>
<li class="toctree-l2"><a class="reference internal" href="04.15-Further-Resources.html">Further Resources</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Machine Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="05.00-Machine-Learning.html">Machine Learning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="05.01-What-Is-Machine-Learning.html">What Is Machine Learning?</a></li>
<li class="toctree-l2"><a class="reference internal" href="05.02-Introducing-Scikit-Learn.html">Introducing Scikit-Learn</a></li>
<li class="toctree-l2"><a class="reference internal" href="05.03-Hyperparameters-and-Model-Validation.html">Hyperparameters and Model Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="05.04-Feature-Engineering.html">Feature Engineering</a></li>
<li class="toctree-l2"><a class="reference internal" href="05.05-Naive-Bayes.html">Naive Bayes Classification</a></li>



<li class="toctree-l2"><a class="reference internal" href="05.05-Bayesian-Decision-Theory.html">Bayesian Decision Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="Mahalanobis-Distance.html">Mahalanobis Distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="05.06-Linear-Regression.html">Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="05.07-Support-Vector-Machines.html">Support Vector Machines</a></li>
<li class="toctree-l2"><a class="reference internal" href="05.08-Random-Forests.html">Decision Trees and Random Forests</a></li>
<li class="toctree-l2"><a class="reference internal" href="05.09-Principal-Component-Analysis.html">Principal Component Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="05.10-Manifold-Learning.html">Manifold Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="05.11-K-Means.html">k-Means Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="05.12-Gaussian-Mixtures.html">Gaussian Mixture Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="05.13-Kernel-Density-Estimation.html">Kernel Density Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="05.14-Image-Features.html">Application: A Face Detection Pipeline</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/fum-cs/data-mining/blob/main/docs/03.11-Working-with-Time-Series.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/fum-cs/data-mining" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/fum-cs/data-mining/issues/new?title=Issue%20on%20page%20%2F03.11-Working-with-Time-Series.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/03.11-Working-with-Time-Series.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Working with Time Series</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dates-and-times-in-python">Dates and Times in Python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#native-python-dates-and-times-datetime-and-dateutil">Native Python Dates and Times: datetime and dateutil</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#typed-arrays-of-times-numpy-s-datetime64">Typed Arrays of Times: NumPy’s datetime64</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dates-and-times-in-pandas-the-best-of-both-worlds">Dates and Times in Pandas: The Best of Both Worlds</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-time-series-indexing-by-time">Pandas Time Series: Indexing by Time</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-time-series-data-structures">Pandas Time Series Data Structures</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regular-sequences-pd-date-range">Regular Sequences: pd.date_range</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#frequencies-and-offsets">Frequencies and Offsets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resampling-shifting-and-windowing">Resampling, Shifting, and Windowing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resampling-and-converting-frequencies">Resampling and Converting Frequencies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-shifts">Time Shifts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rolling-windows">Rolling Windows</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#where-to-learn-more">Where to Learn More</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-visualizing-seattle-bicycle-counts">Example: Visualizing Seattle Bicycle Counts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-data">Visualizing the Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#digging-into-the-data">Digging into the Data</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="working-with-time-series">
<h1>Working with Time Series<a class="headerlink" href="#working-with-time-series" title="Link to this heading">#</a></h1>
<p>Pandas was originally developed in the context of financial modeling, so as you might expect, it contains an extensive set of tools for working with dates, times, and time-indexed data.
Date and time data comes in a few flavors, which we will discuss here:</p>
<ul class="simple">
<li><p><em>Timestamps</em> reference particular moments in time (e.g., July 4th, 2021 at 7:00 a.m.).</p></li>
<li><p><em>Time intervals</em> and <em>periods</em> reference a length of time between a particular beginning and end point; for example, the month of June 2021. Periods usually reference a special case of time intervals in which each interval is of uniform length and does not overlap (e.g., 24-hour-long periods comprising days).</p></li>
<li><p><em>Time deltas</em> or <em>durations</em> reference an exact length of time (e.g., a duration of 22.56 seconds).</p></li>
</ul>
<p>This chapter will introduce how to work with each of these types of date/time data in Pandas.
This is by no means a complete guide to the time series tools available in Python or Pandas, but instead is intended as a broad overview of how you as a user should approach working with time series.
We will start with a brief discussion of tools for dealing with dates and times in Python, before moving more specifically to a discussion of the tools provided by Pandas.
After listing some resources that go into more depth, we will review some short examples of working with time series data in Pandas.</p>
<section id="dates-and-times-in-python">
<h2>Dates and Times in Python<a class="headerlink" href="#dates-and-times-in-python" title="Link to this heading">#</a></h2>
<p>The Python world has a number of available representations of dates, times, deltas, and time spans.
While the time series tools provided by Pandas tend to be the most useful for data science applications, it is helpful to see their relationship to other tools used in Python.</p>
<section id="native-python-dates-and-times-datetime-and-dateutil">
<h3>Native Python Dates and Times: datetime and dateutil<a class="headerlink" href="#native-python-dates-and-times-datetime-and-dateutil" title="Link to this heading">#</a></h3>
<p>Python’s basic objects for working with dates and times reside in the built-in <code class="docutils literal notranslate"><span class="pre">datetime</span></code> module.
Along with the third-party <code class="docutils literal notranslate"><span class="pre">dateutil</span></code> module, you can use this to quickly perform a host of useful functionalities on dates and times.
For example, you can manually build a date using the <code class="docutils literal notranslate"><span class="pre">datetime</span></code> type:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="n">datetime</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2021</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime.datetime(2021, 7, 4, 0, 0)
</pre></div>
</div>
</div>
</div>
<p>Or, using the <code class="docutils literal notranslate"><span class="pre">dateutil</span></code> module, you can parse dates from a variety of string formats:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dateutil</span> <span class="kn">import</span> <span class="n">parser</span>
<span class="n">date</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;4th of July, 2021&quot;</span><span class="p">)</span>
<span class="n">date</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime.datetime(2021, 7, 4, 0, 0)
</pre></div>
</div>
</div>
</div>
<p>Once you have a <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object, you can do things like printing the day of the week:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%A&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Sunday&#39;
</pre></div>
</div>
</div>
</div>
<p>Here we’ve used one of the standard string format codes for printing dates (<code class="docutils literal notranslate"><span class="pre">'%A'</span></code>), which you can read about in the <a class="reference external" href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior"><code class="docutils literal notranslate"><span class="pre">strftime</span></code> section</a> of Python’s <a class="reference external" href="https://docs.python.org/3/library/datetime.html"><code class="docutils literal notranslate"><span class="pre">datetime</span></code> documentation</a>.
Documentation of other useful date utilities can be found in <a class="reference external" href="http://labix.org/python-dateutil"><code class="docutils literal notranslate"><span class="pre">dateutil</span></code>’s online documentation</a>.
A related package to be aware of is <a class="reference external" href="http://pytz.sourceforge.net/"><code class="docutils literal notranslate"><span class="pre">pytz</span></code></a>, which contains tools for working with the most migraine-inducing element of time series data: time zones.</p>
<p>The power of <code class="docutils literal notranslate"><span class="pre">datetime</span></code> and <code class="docutils literal notranslate"><span class="pre">dateutil</span></code> lies in their flexibility and easy syntax: you can use these objects and their built-in methods to easily perform nearly any operation you might be interested in.
Where they break down is when you wish to work with large arrays of dates and times:
just as lists of Python numerical variables are suboptimal compared to NumPy-style typed numerical arrays, lists of Python <code class="docutils literal notranslate"><span class="pre">datetime</span></code> objects are suboptimal compared to typed arrays of encoded dates.</p>
</section>
<section id="typed-arrays-of-times-numpy-s-datetime64">
<h3>Typed Arrays of Times: NumPy’s datetime64<a class="headerlink" href="#typed-arrays-of-times-numpy-s-datetime64" title="Link to this heading">#</a></h3>
<p>NumPy’s <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> dtype encodes dates as 64-bit integers, and thus allows arrays of dates to be represented compactly and operated on in an efficient manner.
The <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> requires a specific input format:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">date</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s1">&#39;2021-07-04&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">)</span>
<span class="n">date</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array(&#39;2021-07-04&#39;, dtype=&#39;datetime64[D]&#39;)
</pre></div>
</div>
</div>
</div>
<p>Once we have dates in this form, we can quickly do vectorized operations on it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;2021-07-04&#39;, &#39;2021-07-05&#39;, &#39;2021-07-06&#39;, &#39;2021-07-07&#39;,
       &#39;2021-07-08&#39;, &#39;2021-07-09&#39;, &#39;2021-07-10&#39;, &#39;2021-07-11&#39;,
       &#39;2021-07-12&#39;, &#39;2021-07-13&#39;, &#39;2021-07-14&#39;, &#39;2021-07-15&#39;],
      dtype=&#39;datetime64[D]&#39;)
</pre></div>
</div>
</div>
</div>
<p>Because of the uniform type in NumPy <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> arrays, this kind of operation can be accomplished much more quickly than if we were working directly with Python’s <code class="docutils literal notranslate"><span class="pre">datetime</span></code> objects, especially as arrays get large
(we introduced this type of vectorization in <a class="reference internal" href="02.03-Computation-on-arrays-ufuncs.html"><span class="std std-doc">Computation on NumPy Arrays: Universal Functions</span></a>).</p>
<p>One detail of the <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> and related <code class="docutils literal notranslate"><span class="pre">timedelta64</span></code> objects is that they are built on a <em>fundamental time unit</em>.
Because the <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> object is limited to 64-bit precision, the range of encodable times is <span class="math notranslate nohighlight">\(2^{64}\)</span> times this fundamental unit.
In other words, <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> imposes a trade-off between <em>time resolution</em> and <em>maximum time span</em>.</p>
<p>For example, if you want a time resolution of 1 nanosecond, you only have enough information to encode a range of <span class="math notranslate nohighlight">\(2^{64}\)</span> nanoseconds, or just under 600 years.
NumPy will infer the desired unit from the input; for example, here is a day-based <code class="docutils literal notranslate"><span class="pre">datetime</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2021-07-04&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numpy.datetime64(&#39;2021-07-04&#39;)
</pre></div>
</div>
</div>
</div>
<p>Here is a minute-based datetime:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2021-07-04 12:00&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numpy.datetime64(&#39;2021-07-04T12:00&#39;)
</pre></div>
</div>
</div>
</div>
<p>You can force any desired fundamental unit using one of many format codes; for example, here we’ll force a nanosecond-based time:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2021-07-04 12:59:59.50&#39;</span><span class="p">,</span> <span class="s1">&#39;ns&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numpy.datetime64(&#39;2021-07-04T12:59:59.500000000&#39;)
</pre></div>
</div>
</div>
</div>
<p>The following table, drawn from the NumPy <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> documentation, lists the available format codes along with the relative and absolute time spans that they can encode:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Code</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Time span (relative)</p></th>
<th class="head"><p>Time span (absolute)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
<td><p>Year</p></td>
<td><p>± 9.2e18 years</p></td>
<td><p>[9.2e18 BC, 9.2e18 AD]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">M</span></code></p></td>
<td><p>Month</p></td>
<td><p>± 7.6e17 years</p></td>
<td><p>[7.6e17 BC, 7.6e17 AD]</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">W</span></code></p></td>
<td><p>Week</p></td>
<td><p>± 1.7e17 years</p></td>
<td><p>[1.7e17 BC, 1.7e17 AD]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">D</span></code></p></td>
<td><p>Day</p></td>
<td><p>± 2.5e16 years</p></td>
<td><p>[2.5e16 BC, 2.5e16 AD]</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">h</span></code></p></td>
<td><p>Hour</p></td>
<td><p>± 1.0e15 years</p></td>
<td><p>[1.0e15 BC, 1.0e15 AD]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p>Minute</p></td>
<td><p>± 1.7e13 years</p></td>
<td><p>[1.7e13 BC, 1.7e13 AD]</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">s</span></code></p></td>
<td><p>Second</p></td>
<td><p>± 2.9e12 years</p></td>
<td><p>[ 2.9e9 BC, 2.9e9 AD]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ms</span></code></p></td>
<td><p>Millisecond</p></td>
<td><p>± 2.9e9 years</p></td>
<td><p>[ 2.9e6 BC, 2.9e6 AD]</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">us</span></code></p></td>
<td><p>Microsecond</p></td>
<td><p>± 2.9e6 years</p></td>
<td><p>[290301 BC, 294241 AD]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ns</span></code></p></td>
<td><p>Nanosecond</p></td>
<td><p>± 292 years</p></td>
<td><p>[ 1678 AD, 2262 AD]</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ps</span></code></p></td>
<td><p>Picosecond</p></td>
<td><p>± 106 days</p></td>
<td><p>[ 1969 AD, 1970 AD]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">fs</span></code></p></td>
<td><p>Femtosecond</p></td>
<td><p>± 2.6 hours</p></td>
<td><p>[ 1969 AD, 1970 AD]</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">as</span></code></p></td>
<td><p>Attosecond</p></td>
<td><p>± 9.2 seconds</p></td>
<td><p>[ 1969 AD, 1970 AD]</p></td>
</tr>
</tbody>
</table>
</div>
<p>For the types of data we see in the real world, a useful default is <code class="docutils literal notranslate"><span class="pre">datetime64[ns]</span></code>, as it can encode a useful range of modern dates with a suitably fine precision.</p>
<p>Finally, note that while the <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> data type addresses some of the deficiencies of the built-in Python <code class="docutils literal notranslate"><span class="pre">datetime</span></code> type, it lacks many of the convenient methods and functions provided by <code class="docutils literal notranslate"><span class="pre">datetime</span></code> and especially <code class="docutils literal notranslate"><span class="pre">dateutil</span></code>.
More information can be found in <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/arrays.datetime.html">NumPy’s <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> documentation</a>.</p>
</section>
<section id="dates-and-times-in-pandas-the-best-of-both-worlds">
<h3>Dates and Times in Pandas: The Best of Both Worlds<a class="headerlink" href="#dates-and-times-in-pandas-the-best-of-both-worlds" title="Link to this heading">#</a></h3>
<p>Pandas builds upon all the tools just discussed to provide a <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code> object, which combines the ease of use of <code class="docutils literal notranslate"><span class="pre">datetime</span></code> and <code class="docutils literal notranslate"><span class="pre">dateutil</span></code> with the efficient storage and vectorized interface of <code class="docutils literal notranslate"><span class="pre">numpy.datetime64</span></code>.
From a group of these <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code> objects, Pandas can construct a <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code> that can be used to index data in a <code class="docutils literal notranslate"><span class="pre">Series</span></code> or <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<p>For example, we can use Pandas tools to repeat the demonstration from earlier.
We can parse a flexibly formatted string date and use format codes to output the day of the week, as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;4th of July, 2021&quot;</span><span class="p">)</span>
<span class="n">date</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2021-07-04 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%A&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Sunday&#39;
</pre></div>
</div>
</div>
</div>
<p>Additionally, we can do NumPy-style vectorized operations directly on this same object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2021-07-04&#39;, &#39;2021-07-05&#39;, &#39;2021-07-06&#39;, &#39;2021-07-07&#39;,
               &#39;2021-07-08&#39;, &#39;2021-07-09&#39;, &#39;2021-07-10&#39;, &#39;2021-07-11&#39;,
               &#39;2021-07-12&#39;, &#39;2021-07-13&#39;, &#39;2021-07-14&#39;, &#39;2021-07-15&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=None)
</pre></div>
</div>
</div>
</div>
<p>In the next section, we will take a closer look at manipulating time series data with the tools provided by Pandas.</p>
</section>
</section>
<section id="pandas-time-series-indexing-by-time">
<h2>Pandas Time Series: Indexing by Time<a class="headerlink" href="#pandas-time-series-indexing-by-time" title="Link to this heading">#</a></h2>
<p>The Pandas time series tools really become useful when you begin to index data by timestamps.
For example, we can construct a <code class="docutils literal notranslate"><span class="pre">Series</span></code> object that has time-indexed data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2020-07-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-08-04&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;2021-07-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-08-04&#39;</span><span class="p">])</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2020-07-04    0
2020-08-04    1
2021-07-04    2
2021-08-04    3
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>And now that we have this data in a <code class="docutils literal notranslate"><span class="pre">Series</span></code>, we can make use of any of the <code class="docutils literal notranslate"><span class="pre">Series</span></code> indexing patterns we discussed in previous chapters, passing values that can be coerced into dates:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;2020-07-04&#39;</span><span class="p">:</span><span class="s1">&#39;2021-07-04&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2020-07-04    0
2020-08-04    1
2021-07-04    2
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>There are additional special date-only indexing operations, such as passing a year to obtain a slice of all data from that year:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;2021&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-07-04    2
2021-08-04    3
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Later, we will see additional examples of the convenience of dates-as-indices.
But first, let’s take a closer look at the available time series data structures.</p>
</section>
<section id="pandas-time-series-data-structures">
<h2>Pandas Time Series Data Structures<a class="headerlink" href="#pandas-time-series-data-structures" title="Link to this heading">#</a></h2>
<p>This section will introduce the fundamental Pandas data structures for working with time series data:</p>
<ul class="simple">
<li><p>For <em>timestamps</em>, Pandas provides the <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code> type. As mentioned before, this is essentially a replacement for Python’s native <code class="docutils literal notranslate"><span class="pre">datetime</span></code>, but it’s based on the more efficient <code class="docutils literal notranslate"><span class="pre">numpy.datetime64</span></code> data type. The associated <code class="docutils literal notranslate"><span class="pre">Index</span></code> structure is <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code>.</p></li>
<li><p>For <em>time periods</em>, Pandas provides the <code class="docutils literal notranslate"><span class="pre">Period</span></code> type. This encodes a fixed-frequency interval based on <code class="docutils literal notranslate"><span class="pre">numpy.datetime64</span></code>. The associated index structure is <code class="docutils literal notranslate"><span class="pre">PeriodIndex</span></code>.</p></li>
<li><p>For <em>time deltas</em> or <em>durations</em>, Pandas provides the <code class="docutils literal notranslate"><span class="pre">Timedelta</span></code> type. <code class="docutils literal notranslate"><span class="pre">Timedelta</span></code> is a more efficient replacement for Python’s native <code class="docutils literal notranslate"><span class="pre">datetime.timedelta</span></code> type, and is based on <code class="docutils literal notranslate"><span class="pre">numpy.timedelta64</span></code>. The associated index structure is <code class="docutils literal notranslate"><span class="pre">TimedeltaIndex</span></code>.</p></li>
</ul>
<p>The most fundamental of these date/time objects are the <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code> and <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code> objects.
While these class objects can be invoked directly, it is more common to use the <code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code> function, which can parse a wide variety of formats.
Passing a single date to <code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code> yields a <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code>; passing a series of dates by default yields a <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code>, as you can see here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;4th of July, 2021&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;2021-Jul-6&#39;</span><span class="p">,</span> <span class="s1">&#39;07-07-2021&#39;</span><span class="p">,</span> <span class="s1">&#39;20210708&#39;</span><span class="p">])</span>
<span class="n">dates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2021-07-03&#39;, &#39;2021-07-04&#39;, &#39;2021-07-06&#39;, &#39;2021-07-07&#39;,
               &#39;2021-07-08&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=None)
</pre></div>
</div>
</div>
</div>
<p>Any <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code> can be converted to a <code class="docutils literal notranslate"><span class="pre">PeriodIndex</span></code> with the <code class="docutils literal notranslate"><span class="pre">to_period</span></code> function, with the addition of a frequency code; here we’ll use <code class="docutils literal notranslate"><span class="pre">'D'</span></code> to indicate daily frequency:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dates</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PeriodIndex([&#39;2021-07-03&#39;, &#39;2021-07-04&#39;, &#39;2021-07-06&#39;, &#39;2021-07-07&#39;,
             &#39;2021-07-08&#39;],
            dtype=&#39;period[D]&#39;)
</pre></div>
</div>
</div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">TimedeltaIndex</span></code> is created, for example, when a date is subtracted from another:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dates</span> <span class="o">-</span> <span class="n">dates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TimedeltaIndex([&#39;0 days&#39;, &#39;1 days&#39;, &#39;3 days&#39;, &#39;4 days&#39;, &#39;5 days&#39;], dtype=&#39;timedelta64[ns]&#39;, freq=None)
</pre></div>
</div>
</div>
</div>
</section>
<section id="regular-sequences-pd-date-range">
<h2>Regular Sequences: pd.date_range<a class="headerlink" href="#regular-sequences-pd-date-range" title="Link to this heading">#</a></h2>
<p>To make creation of regular date sequences more convenient, Pandas offers a few functions for this purpose: <code class="docutils literal notranslate"><span class="pre">pd.date_range</span></code> for timestamps, <code class="docutils literal notranslate"><span class="pre">pd.period_range</span></code> for periods, and <code class="docutils literal notranslate"><span class="pre">pd.timedelta_range</span></code> for time deltas.
We’ve seen that Python’s <code class="docutils literal notranslate"><span class="pre">range</span></code> and NumPy’s <code class="docutils literal notranslate"><span class="pre">np.arange</span></code> take a start point, end point, and optional step size and return a sequence.
Similarly, <code class="docutils literal notranslate"><span class="pre">pd.date_range</span></code> accepts a start date, an end date, and an optional frequency code to create a regular sequence of dates:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2015-07-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-10&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2015-07-03&#39;, &#39;2015-07-04&#39;, &#39;2015-07-05&#39;, &#39;2015-07-06&#39;,
               &#39;2015-07-07&#39;, &#39;2015-07-08&#39;, &#39;2015-07-09&#39;, &#39;2015-07-10&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)
</pre></div>
</div>
</div>
</div>
<p>Alternatively, the date range can be specified not with a start and end point, but with a start point and a number of periods:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2015-07-03&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2015-07-03&#39;, &#39;2015-07-04&#39;, &#39;2015-07-05&#39;, &#39;2015-07-06&#39;,
               &#39;2015-07-07&#39;, &#39;2015-07-08&#39;, &#39;2015-07-09&#39;, &#39;2015-07-10&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)
</pre></div>
</div>
</div>
</div>
<p>The spacing can be modified by altering the <code class="docutils literal notranslate"><span class="pre">freq</span></code> argument, which defaults to <code class="docutils literal notranslate"><span class="pre">D</span></code>.
For example, here we construct a range of hourly timestamps:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2015-07-03&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2015-07-03 00:00:00&#39;, &#39;2015-07-03 01:00:00&#39;,
               &#39;2015-07-03 02:00:00&#39;, &#39;2015-07-03 03:00:00&#39;,
               &#39;2015-07-03 04:00:00&#39;, &#39;2015-07-03 05:00:00&#39;,
               &#39;2015-07-03 06:00:00&#39;, &#39;2015-07-03 07:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;H&#39;)
</pre></div>
</div>
</div>
</div>
<p>To create regular sequences of <code class="docutils literal notranslate"><span class="pre">Period</span></code> or <code class="docutils literal notranslate"><span class="pre">Timedelta</span></code> values, the similar <code class="docutils literal notranslate"><span class="pre">pd.period_range</span></code> and <code class="docutils literal notranslate"><span class="pre">pd.timedelta_range</span></code> functions are useful.
Here are some monthly periods:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">period_range</span><span class="p">(</span><span class="s1">&#39;2015-07&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PeriodIndex([&#39;2015-07&#39;, &#39;2015-08&#39;, &#39;2015-09&#39;, &#39;2015-10&#39;, &#39;2015-11&#39;, &#39;2015-12&#39;,
             &#39;2016-01&#39;, &#39;2016-02&#39;],
            dtype=&#39;period[M]&#39;)
</pre></div>
</div>
</div>
</div>
<p>And a sequence of durations increasing by an hour:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">timedelta_range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TimedeltaIndex([&#39;0 days 00:00:00&#39;, &#39;0 days 01:00:00&#39;, &#39;0 days 02:00:00&#39;,
                &#39;0 days 03:00:00&#39;, &#39;0 days 04:00:00&#39;, &#39;0 days 05:00:00&#39;],
               dtype=&#39;timedelta64[ns]&#39;, freq=&#39;H&#39;)
</pre></div>
</div>
</div>
</div>
<p>All of these require an understanding of Pandas frequency codes, which are summarized in the next section.</p>
</section>
<section id="frequencies-and-offsets">
<h2>Frequencies and Offsets<a class="headerlink" href="#frequencies-and-offsets" title="Link to this heading">#</a></h2>
<p>Fundamental to these Pandas time series tools is the concept of a <em>frequency</em> or <em>date offset</em>. The following table summarizes the main codes available; as with the <code class="docutils literal notranslate"><span class="pre">D</span></code> (day) and <code class="docutils literal notranslate"><span class="pre">H</span></code> (hour) codes demonstrated in the previous sections, we can use these to specify any desired frequency spacing:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Code</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">D</span></code></p></td>
<td><p>Calendar day</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">B</span></code></p></td>
<td><p>Business day</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">W</span></code></p></td>
<td><p>Weekly</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">M</span></code></p></td>
<td><p>Month end</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BM</span></code></p></td>
<td><p>Business month end</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Q</span></code></p></td>
<td><p>Quarter end</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BQ</span></code></p></td>
<td><p>Business quarter end</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p>Year end</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BA</span></code></p></td>
<td><p>Business year end</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">H</span></code></p></td>
<td><p>Hours</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BH</span></code></p></td>
<td><p>Business hours</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">T</span></code></p></td>
<td><p>Minutes</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">S</span></code></p></td>
<td><p>Seconds</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">L</span></code></p></td>
<td><p>Milliseconds</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">U</span></code></p></td>
<td><p>Microseconds</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">N</span></code></p></td>
<td><p>Nanoseconds</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
<p>The monthly, quarterly, and annual frequencies are all marked at the end of the specified period.
Adding an <code class="docutils literal notranslate"><span class="pre">S</span></code> suffix to any of these causes them to instead be marked at the beginning:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Code</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MS</span></code></p></td>
<td><p>Month start</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BMS</span></code></p></td>
<td><p>Business month start</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">QS</span></code></p></td>
<td><p>Quarter start</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BQS</span></code></p></td>
<td><p>Business quarter start</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">AS</span></code></p></td>
<td><p>Year start</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BAS</span></code></p></td>
<td><p>Business year start</p></td>
</tr>
</tbody>
</table>
</div>
<p>Additionally, you can change the month used to mark any quarterly or annual code by adding a three-letter month code as a suffix:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Q-JAN</span></code>, <code class="docutils literal notranslate"><span class="pre">BQ-FEB</span></code>, <code class="docutils literal notranslate"><span class="pre">QS-MAR</span></code>, <code class="docutils literal notranslate"><span class="pre">BQS-APR</span></code>, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">A-JAN</span></code>, <code class="docutils literal notranslate"><span class="pre">BA-FEB</span></code>, <code class="docutils literal notranslate"><span class="pre">AS-MAR</span></code>, <code class="docutils literal notranslate"><span class="pre">BAS-APR</span></code>, etc.</p></li>
</ul>
<p>In the same way, the split point of the weekly frequency can be modified by adding a three-letter weekday code:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">W-SUN</span></code>, <code class="docutils literal notranslate"><span class="pre">W-MON</span></code>, <code class="docutils literal notranslate"><span class="pre">W-TUE</span></code>, <code class="docutils literal notranslate"><span class="pre">W-WED</span></code>, etc.</p></li>
</ul>
<p>On top of this, codes can be combined with numbers to specify other frequencies.
For example, for a frequency of 2 hours and 30 minutes, we can combine the hour (<code class="docutils literal notranslate"><span class="pre">H</span></code>) and minute (<code class="docutils literal notranslate"><span class="pre">T</span></code>) codes as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">timedelta_range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;2H30T&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TimedeltaIndex([&#39;0 days 00:00:00&#39;, &#39;0 days 02:30:00&#39;, &#39;0 days 05:00:00&#39;,
                &#39;0 days 07:30:00&#39;, &#39;0 days 10:00:00&#39;, &#39;0 days 12:30:00&#39;],
               dtype=&#39;timedelta64[ns]&#39;, freq=&#39;150T&#39;)
</pre></div>
</div>
</div>
</div>
<p>All of these short codes refer to specific instances of Pandas time series offsets, which can be found in the <code class="docutils literal notranslate"><span class="pre">pd.tseries.offsets</span></code> module.
For example, we can create a business day offset directly as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas.tseries.offsets</span> <span class="kn">import</span> <span class="n">BDay</span>
<span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2015-07-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">BDay</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2015-07-01&#39;, &#39;2015-07-02&#39;, &#39;2015-07-03&#39;, &#39;2015-07-06&#39;,
               &#39;2015-07-07&#39;, &#39;2015-07-08&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;B&#39;)
</pre></div>
</div>
</div>
</div>
<p>For more discussion of the use of frequencies and offsets, see the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#dateoffset-objects"><code class="docutils literal notranslate"><span class="pre">DateOffset</span></code> section</a> of the Pandas documentation.</p>
</section>
<section id="resampling-shifting-and-windowing">
<h2>Resampling, Shifting, and Windowing<a class="headerlink" href="#resampling-shifting-and-windowing" title="Link to this heading">#</a></h2>
<p>The ability to use dates and times as indices to intuitively organize and access data is an important aspect of the Pandas time series tools.
The benefits of indexed data in general (automatic alignment during operations, intuitive data slicing and access, etc.) still apply, and Pandas provides several additional time series–specific operations.</p>
<p>We will take a look at a few of those here, using some stock price data as an example.
Because Pandas was developed largely in a finance context, it includes some very specific tools for financial data.
For example, the accompanying <code class="docutils literal notranslate"><span class="pre">pandas-datareader</span></code> package (installable via <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pandas-datareader</span></code>) knows how to import data from various online sources.
Here we will load part of the S&amp;P 500 price history:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas_datareader</span> <span class="kn">import</span> <span class="n">data</span>

<span class="n">sp500</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s1">&#39;^GSPC&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s1">&#39;2018&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;2022&#39;</span><span class="p">,</span>
                        <span class="n">data_source</span><span class="o">=</span><span class="s1">&#39;yahoo&#39;</span><span class="p">)</span>
<span class="n">sp500</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>High</th>
      <th>Low</th>
      <th>Open</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Adj Close</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-01-02</th>
      <td>2695.889893</td>
      <td>2682.360107</td>
      <td>2683.729980</td>
      <td>2695.810059</td>
      <td>3367250000</td>
      <td>2695.810059</td>
    </tr>
    <tr>
      <th>2018-01-03</th>
      <td>2714.370117</td>
      <td>2697.770020</td>
      <td>2697.850098</td>
      <td>2713.060059</td>
      <td>3538660000</td>
      <td>2713.060059</td>
    </tr>
    <tr>
      <th>2018-01-04</th>
      <td>2729.290039</td>
      <td>2719.070068</td>
      <td>2719.310059</td>
      <td>2723.989990</td>
      <td>3695260000</td>
      <td>2723.989990</td>
    </tr>
    <tr>
      <th>2018-01-05</th>
      <td>2743.449951</td>
      <td>2727.919922</td>
      <td>2731.330078</td>
      <td>2743.149902</td>
      <td>3236620000</td>
      <td>2743.149902</td>
    </tr>
    <tr>
      <th>2018-01-08</th>
      <td>2748.510010</td>
      <td>2737.600098</td>
      <td>2742.669922</td>
      <td>2747.709961</td>
      <td>3242650000</td>
      <td>2747.709961</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>For simplicity, we’ll use just the closing price:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp500</span> <span class="o">=</span> <span class="n">sp500</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>We can visualize this using the <code class="docutils literal notranslate"><span class="pre">plot</span></code> method, after the normal Matplotlib setup boilerplate (see <a class="reference internal" href="04.00-Introduction-To-Matplotlib.html"><span class="std std-doc">Part 4</span></a>); the result is shown in the following figure:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-whitegrid&#39;</span><span class="p">)</span>
<span class="n">sp500</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/258f9ff08fbf98d1b14087b51817e71b88ae378e79bce74785eaec4383d65045.png" src="_images/258f9ff08fbf98d1b14087b51817e71b88ae378e79bce74785eaec4383d65045.png" />
</div>
</div>
<section id="resampling-and-converting-frequencies">
<h3>Resampling and Converting Frequencies<a class="headerlink" href="#resampling-and-converting-frequencies" title="Link to this heading">#</a></h3>
<p>One common need when dealing with time series data is resampling at a higher or lower frequency.
This can be done using the <code class="docutils literal notranslate"><span class="pre">resample</span></code> method, or the much simpler <code class="docutils literal notranslate"><span class="pre">asfreq</span></code> method.
The primary difference between the two is that <code class="docutils literal notranslate"><span class="pre">resample</span></code> is fundamentally a <em>data aggregation</em>, while <code class="docutils literal notranslate"><span class="pre">asfreq</span></code> is fundamentally a <em>data selection</em>.</p>
<p>Let’s compare what the two return when we downsample the S&amp;P 500 closing price data.
Here we will resample the data at the end of business year; the following figure shows the result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp500</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">sp500</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;BA&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="n">sp500</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s1">&#39;BA&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="s1">&#39;resample&#39;</span><span class="p">,</span> <span class="s1">&#39;asfreq&#39;</span><span class="p">],</span>
           <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8e72a00db1f89da30442bdf106687c3bcf32a0737e24d97f4263cdcbb7a6154e.png" src="_images/8e72a00db1f89da30442bdf106687c3bcf32a0737e24d97f4263cdcbb7a6154e.png" />
</div>
</div>
<p>Notice the difference: at each point, <code class="docutils literal notranslate"><span class="pre">resample</span></code> reports the <em>average of the previous year</em>, while <code class="docutils literal notranslate"><span class="pre">asfreq</span></code> reports the <em>value at the end of the year</em>.</p>
<p>For upsampling, <code class="docutils literal notranslate"><span class="pre">resample</span></code> and <code class="docutils literal notranslate"><span class="pre">asfreq</span></code> are largely equivalent, though <code class="docutils literal notranslate"><span class="pre">resample</span></code> has many more options available.
In this case, the default for both methods is to leave the upsampled points empty; that is, filled with NA values.
Like the <code class="docutils literal notranslate"><span class="pre">pd.fillna</span></code> function discussed in <a class="reference internal" href="03.04-Missing-Values.html"><span class="std std-doc">Handling Missing Data</span></a>, <code class="docutils literal notranslate"><span class="pre">asfreq</span></code> accepts a <code class="docutils literal notranslate"><span class="pre">method</span></code> argument to specify how values are imputed.
Here, we will resample the business day data at a daily frequency (i.e., including weekends); the following figure shows the result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">sp500</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bfill&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;-o&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;--o&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;back-fill&quot;</span><span class="p">,</span> <span class="s2">&quot;forward-fill&quot;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3d8399eab7aede46f062e0cc8f0b2d5164e31f7c90b945ae34ec18c05412d409.png" src="_images/3d8399eab7aede46f062e0cc8f0b2d5164e31f7c90b945ae34ec18c05412d409.png" />
</div>
</div>
<p>Because the S&amp;P 500 data only exists for business days, the top panel has gaps representing NA values.
The bottom panel shows the differences between two strategies for filling the gaps: forward filling and backward filling.</p>
</section>
<section id="time-shifts">
<h3>Time Shifts<a class="headerlink" href="#time-shifts" title="Link to this heading">#</a></h3>
<p>Another common time series–specific operation is shifting of data in time.
For this, Pandas provides the <code class="docutils literal notranslate"><span class="pre">shift</span></code> method, which can be used to shift data by a given number of entries.
With time series data sampled at a regular frequency, this can give us a way to explore trends over time.</p>
<p>For example, here we resample the data to daily values, and shift by 364 to compute the 1-year return on investment for the S&amp;P 500 over time (see the following figure):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp500</span> <span class="o">=</span> <span class="n">sp500</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;pad&#39;</span><span class="p">)</span>

<span class="n">ROI</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">sp500</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">365</span><span class="p">)</span> <span class="o">-</span> <span class="n">sp500</span><span class="p">)</span> <span class="o">/</span> <span class="n">sp500</span>
<span class="n">ROI</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;% Return on Investment after 1 year&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1208e2478bad5b9da0ab5027fd71bce3ef582a520beb09485e6c4b718fd9c868.png" src="_images/1208e2478bad5b9da0ab5027fd71bce3ef582a520beb09485e6c4b718fd9c868.png" />
</div>
</div>
<p>The worst one-year return was around March 2019, with the coronavirus-related market crash exactly a year later. As you might expect, the best one-year return was to be found in March 2020, for those with enough foresight or luck to buy low.</p>
</section>
<section id="rolling-windows">
<h3>Rolling Windows<a class="headerlink" href="#rolling-windows" title="Link to this heading">#</a></h3>
<p>Calculating rolling statistics is a third type of time series–specific operation implemented by Pandas.
This can be accomplished via the <code class="docutils literal notranslate"><span class="pre">rolling</span></code> attribute of <code class="docutils literal notranslate"><span class="pre">Series</span></code> and <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects, which returns a view similar to what we saw with the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> operation (see <a class="reference internal" href="03.08-Aggregation-and-Grouping.html"><span class="std std-doc">Aggregation and Grouping</span></a>).
This rolling view makes available a number of aggregation operations by default.</p>
<p>For example, we can look at the one-year centered rolling mean and standard deviation of the  stock prices (see the following figure):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rolling</span> <span class="o">=</span> <span class="n">sp500</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">365</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;input&#39;</span><span class="p">:</span> <span class="n">sp500</span><span class="p">,</span>
                     <span class="s1">&#39;one-year rolling_mean&#39;</span><span class="p">:</span> <span class="n">rolling</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
                     <span class="s1">&#39;one-year rolling_median&#39;</span><span class="p">:</span> <span class="n">rolling</span><span class="o">.</span><span class="n">median</span><span class="p">()})</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b16220a7503a6385c4562556bb07f1f8326663a6d8f75b7c4dc2f98f04620716.png" src="_images/b16220a7503a6385c4562556bb07f1f8326663a6d8f75b7c4dc2f98f04620716.png" />
</div>
</div>
<p>As with <code class="docutils literal notranslate"><span class="pre">groupby</span></code> operations, the <code class="docutils literal notranslate"><span class="pre">aggregate</span></code> and <code class="docutils literal notranslate"><span class="pre">apply</span></code> methods can be used for custom rolling computations.</p>
</section>
</section>
<section id="where-to-learn-more">
<h2>Where to Learn More<a class="headerlink" href="#where-to-learn-more" title="Link to this heading">#</a></h2>
<p>This chapter has provided only a brief summary of some of the most essential features of time series tools provided by Pandas; for a more complete discussion, you can refer to the <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/timeseries.html">“Time Series/Date Functionality” section</a> of the Pandas online documentation.</p>
<p>Another excellent resource is the book <a class="reference external" href="https://learning.oreilly.com/library/view/python-for-data/9781098104023/"><em>Python for Data Analysis</em></a> by Wes McKinney (O’Reilly).
It is an invaluable resource on the use of Pandas.
In particular, this book emphasizes time series tools in the context of business and finance, and focuses much more on particular details of business calendars, time zones, and related topics.</p>
<p>As always, you can also use the IPython help functionality to explore and try out further options available to the functions and methods discussed here. I find this often is the best way to learn a new Python tool.</p>
</section>
<section id="example-visualizing-seattle-bicycle-counts">
<h2>Example: Visualizing Seattle Bicycle Counts<a class="headerlink" href="#example-visualizing-seattle-bicycle-counts" title="Link to this heading">#</a></h2>
<p>As a more involved example of working with time series data, let’s take a look at bicycle counts on Seattle’s <a class="reference external" href="http://www.openstreetmap.org/#map=17/47.64813/-122.34965">Fremont Bridge</a>.
This data comes from an automated bicycle counter installed in late 2012, which has inductive sensors on the east and west sidewalks of the bridge.
The hourly bicycle counts can be downloaded from <a class="reference external" href="http://data.seattle.gov">http://data.seattle.gov</a>; the Fremont Bridge Bicycle Counter dataset is available under the Transportation category.</p>
<p>The CSV used for this book can be downloaded as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># url = (&#39;https://raw.githubusercontent.com/jakevdp/&#39;</span>
<span class="c1">#        &#39;bicycle-data/main/FremontBridge.csv&#39;)</span>
<span class="c1"># !curl -O {url}</span>
</pre></div>
</div>
</div>
</div>
<p>Once this dataset is downloaded, we can use Pandas to read the CSV output into a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.
We will specify that we want the <code class="docutils literal notranslate"><span class="pre">Date</span></code> column as an index, and we want these dates to be automatically parsed:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;FremontBridge.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Fremont Bridge Total</th>
      <th>Fremont Bridge East Sidewalk</th>
      <th>Fremont Bridge West Sidewalk</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-11-01 00:00:00</th>
      <td>12.0</td>
      <td>7.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2019-11-01 01:00:00</th>
      <td>7.0</td>
      <td>0.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>2019-11-01 02:00:00</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2019-11-01 03:00:00</th>
      <td>6.0</td>
      <td>6.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2019-11-01 04:00:00</th>
      <td>6.0</td>
      <td>5.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>For convenience, we’ll shorten the column names:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">,</span> <span class="s1">&#39;East&#39;</span><span class="p">,</span> <span class="s1">&#39;West&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s take a look at the summary statistics for this data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total</th>
      <th>East</th>
      <th>West</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>147255.000000</td>
      <td>147255.000000</td>
      <td>147255.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>110.341462</td>
      <td>50.077763</td>
      <td>60.263699</td>
    </tr>
    <tr>
      <th>std</th>
      <td>140.422051</td>
      <td>64.634038</td>
      <td>87.252147</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>14.000000</td>
      <td>6.000000</td>
      <td>7.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>60.000000</td>
      <td>28.000000</td>
      <td>30.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>145.000000</td>
      <td>68.000000</td>
      <td>74.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1097.000000</td>
      <td>698.000000</td>
      <td>850.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="visualizing-the-data">
<h3>Visualizing the Data<a class="headerlink" href="#visualizing-the-data" title="Link to this heading">#</a></h3>
<p>We can gain some insight into the dataset by visualizing it.
Let’s start by plotting the raw data (see the following figure):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Hourly Bicycle Count&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/79d7e2a957776f723272b4bc4f56e0133ab2c1a62ddd53e29107339dd2071c39.png" src="_images/79d7e2a957776f723272b4bc4f56e0133ab2c1a62ddd53e29107339dd2071c39.png" />
</div>
</div>
<p>The ~150,000 hourly samples are far too dense for us to make much sense of.
We can gain more insight by resampling the data to a coarser grid.
Let’s resample by week (see the following figure):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weekly</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">weekly</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Weekly bicycle count&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/070015680a98a64c833bd672e30fed3f2e141e885117b4c3c0d83b6b90cb8a5c.png" src="_images/070015680a98a64c833bd672e30fed3f2e141e885117b4c3c0d83b6b90cb8a5c.png" />
</div>
</div>
<p>This reveals some trends: as you might expect, people bicycle more in the summer than in the winter, and even within a particular season the bicycle use varies from week to week (likely dependent on weather; see <a class="reference internal" href="05.06-Linear-Regression.html"><span class="std std-doc">Linear Regression</span></a>, where we explore this further). Further, the effect of the COVID-19 pandemic on commuting patterns is quite clear, starting in early 2020.</p>
<p>Another option that comes in handy for aggregating the data is to use a rolling mean, utilizing the <code class="docutils literal notranslate"><span class="pre">pd.rolling_mean</span></code> function.
Here we’ll examine the 30-day rolling mean of our data, making sure to center the window (see the following figure):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">daily</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">daily</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;mean hourly count&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/055d11f309f475e244ddb2b544c1f1383f54bf10b5ce1398b7d8c697bb101511.png" src="_images/055d11f309f475e244ddb2b544c1f1383f54bf10b5ce1398b7d8c697bb101511.png" />
</div>
</div>
<p>The jaggedness of the result is due to the hard cutoff of the window.
We can get a smoother version of a rolling mean using a window function—for example, a Gaussian window, as shown in the following figure.
The following code specifies both the width of the window (here, 50 days) and the width of the Gaussian window (here, 10 days):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">daily</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">win_type</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">std</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/873db455793cad066b9e1791e9fd0f6477ea9cc0b060912d700c3298ae47d67b.png" src="_images/873db455793cad066b9e1791e9fd0f6477ea9cc0b060912d700c3298ae47d67b.png" />
</div>
</div>
</section>
<section id="digging-into-the-data">
<h3>Digging into the Data<a class="headerlink" href="#digging-into-the-data" title="Link to this heading">#</a></h3>
<p>While these smoothed data views are useful to get an idea of the general trend in the data, they hide much of the structure.
For example, we might want to look at the average traffic as a function of the time of day.
We can do this using the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> functionality discussed in <a class="reference internal" href="03.08-Aggregation-and-Grouping.html"><span class="std std-doc">Aggregation and Grouping</span></a> (see the following figure):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">by_time</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">time</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">hourly_ticks</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">by_time</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="n">hourly_ticks</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/80033bb66477f90f9c1a506a918f067570bb35cbaaf03d8c9630c3b0e095d88c.png" src="_images/80033bb66477f90f9c1a506a918f067570bb35cbaaf03d8c9630c3b0e095d88c.png" />
</div>
</div>
<p>The hourly traffic is a strongly bimodal sequence, with peaks around 8:00 a.m. and 5:00 p.m.
This is likely evidence of a strong component of commuter traffic crossing the bridge.
There is a directional component as well: according to the data, the east sidewalk is used more during the a.m. commute, and the west sidewalk is used more during the p.m. commute.</p>
<p>We also might be curious about how things change based on the day of the week. Again, we can do this with a simple <code class="docutils literal notranslate"><span class="pre">groupby</span></code> (see the following figure):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">by_weekday</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofweek</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">by_weekday</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mon&#39;</span><span class="p">,</span> <span class="s1">&#39;Tues&#39;</span><span class="p">,</span> <span class="s1">&#39;Wed&#39;</span><span class="p">,</span> <span class="s1">&#39;Thurs&#39;</span><span class="p">,</span> <span class="s1">&#39;Fri&#39;</span><span class="p">,</span> <span class="s1">&#39;Sat&#39;</span><span class="p">,</span> <span class="s1">&#39;Sun&#39;</span><span class="p">]</span>
<span class="n">by_weekday</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ab0ef7a99e71880ef6b953d09a47f590744f16a9ccf2446dcdf7edad29b093a6.png" src="_images/ab0ef7a99e71880ef6b953d09a47f590744f16a9ccf2446dcdf7edad29b093a6.png" />
</div>
</div>
<p>This shows a strong distinction between weekday and weekend totals, with around twice as many average riders crossing the bridge on Monday through Friday than on Saturday and Sunday.</p>
<p>With this in mind, let’s do a compound <code class="docutils literal notranslate"><span class="pre">groupby</span></code> and look at the hourly trends on weekdays versus weekends.
We’ll start by grouping by flags marking the weekend and the time of day:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weekend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">weekday</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;Weekday&#39;</span><span class="p">,</span> <span class="s1">&#39;Weekend&#39;</span><span class="p">)</span>
<span class="n">by_time</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">weekend</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">time</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Now we’ll use some of the Matplotlib tools that will be described in <a class="reference internal" href="04.08-Multiple-Subplots.html"><span class="std std-doc">Multiple Subplots</span></a> to plot two panels side by side, as shown in the following figure:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">by_time</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Weekday&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Weekdays&#39;</span><span class="p">,</span>
                            <span class="n">xticks</span><span class="o">=</span><span class="n">hourly_ticks</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">])</span>
<span class="n">by_time</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Weekend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Weekends&#39;</span><span class="p">,</span>
                            <span class="n">xticks</span><span class="o">=</span><span class="n">hourly_ticks</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/22e68804d4590baaea5601df49a9d9bd801d09698e208e23fb20927e0d67bd83.png" src="_images/22e68804d4590baaea5601df49a9d9bd801d09698e208e23fb20927e0d67bd83.png" />
</div>
</div>
<p>The result shows a bimodal commuting pattern during the work week, and a unimodal recreational pattern during the weekends.
It might be interesting to dig through this data in more detail and examine the effects of weather, temperature, time of year, and other factors on people’s commuting patterns; for further discussion, see my blog post <a class="reference external" href="https://jakevdp.github.io/blog/2014/06/10/is-seattle-really-seeing-an-uptick-in-cycling/">“Is Seattle Really Seeing an Uptick in Cycling?”</a>, which uses a subset of this data.
We will also revisit this dataset in the context of modeling in <a class="reference internal" href="05.06-Linear-Regression.html"><span class="std std-doc">Linear Regression</span></a>.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="03.10-Working-With-Strings.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Vectorized String Operations</p>
      </div>
    </a>
    <a class="right-next"
       href="03.12-Performance-Eval-and-Query.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">High-Performance Pandas: eval and query</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dates-and-times-in-python">Dates and Times in Python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#native-python-dates-and-times-datetime-and-dateutil">Native Python Dates and Times: datetime and dateutil</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#typed-arrays-of-times-numpy-s-datetime64">Typed Arrays of Times: NumPy’s datetime64</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dates-and-times-in-pandas-the-best-of-both-worlds">Dates and Times in Pandas: The Best of Both Worlds</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-time-series-indexing-by-time">Pandas Time Series: Indexing by Time</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-time-series-data-structures">Pandas Time Series Data Structures</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regular-sequences-pd-date-range">Regular Sequences: pd.date_range</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#frequencies-and-offsets">Frequencies and Offsets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resampling-shifting-and-windowing">Resampling, Shifting, and Windowing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resampling-and-converting-frequencies">Resampling and Converting Frequencies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-shifts">Time Shifts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rolling-windows">Rolling Windows</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#where-to-learn-more">Where to Learn More</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-visualizing-seattle-bicycle-counts">Example: Visualizing Seattle Bicycle Counts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-data">Visualizing the Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#digging-into-the-data">Digging into the Data</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Mahmood Amintoosi
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025. CC0 Licensed - Computer Science Dept., Ferdowsi University of Mashhad.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>